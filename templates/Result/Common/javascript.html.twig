<script>

        /**
        * Add data  block resume
        **/
        function addResumeBlock(_type, _data){
            document.getElementById('vote-total-'+_type).innerHTML   = _data.total;
            document.getElementById('vote-isgood-'+_type).innerHTML  = _data.isGood;
            document.getElementById('vote-iswhite-'+_type).innerHTML = _data.isWhite;
            document.getElementById('vote-isdead-'+_type).innerHTML  = _data.isDead;
        }

        /**
        * Show result
        **/
        function fetchData() {
            fetch('{{ path('result_ajax') }}')
                .then(response => response.json())
                .then(result => {
                    // Process the data returned from the server
                    const container    = document.getElementById('data-container-vote');
                    const containerMr  = document.getElementById('data-container-vote-mr');
                    const containerMme = document.getElementById('data-container-vote-mme');
                    //container.innerHTML = '';
                    containerMr.innerHTML  = '';
                    containerMme.innerHTML = '';
                    results    = Array.isArray(result) ? result : JSON.parse(result);
                    data       = results['data'];
                    countMen   = results['count']['men'];
                    countWomen = results['count']['women'];
                    
                    //Block resume
                    addResumeBlock('mr', countMen) ;
                    addResumeBlock('mme', countWomen) ;
                     
                    data.forEach(item => {
                        const a = document.createElement('a');
                        a.href = '#';
                        a.classList.add('list-group-item', 'list-group-item-action', 'd-flex', 'align-items-center');

                        const img = document.createElement('img');
                        var base_url = window.location.origin;
                        var photo = item.photo != null ? 'upload/profil/'+item.photo : 'images/illustration/no-image.png';
                        img.src = base_url+`/${photo}`;
                        img.alt = 'User Image';
                        img.classList.add('rounded-circle', 'w-px-50');

                        const div1 = document.createElement('div');
                        div1.classList.add('w-100');

                        const div2 = document.createElement('div');
                        div2.classList.add('d-flex', 'justify-content-between');

                        const user_info = document.createElement('div');
                        user_info.classList.add('user-info');

                        const h6 = document.createElement('h6');
                        h6.classList.add('mb-1');
                        h6.textContent = `${item.firstname} ${item.lastname}`; // Assuming 'item' is an object containing the name property
                        const small = document.createElement('small');
                        //const smallNum = document.createElement('smallNum');

                        small.textContent = `Laharana : ${item.number}`; // Assuming 13 minutes is dynamic
                        //smallNum.textContent = `Numéro à l'élection : ${item.number}`; // Assuming 13 minutes is dynamic
                        const user_status = document.createElement('div');
                        user_status.classList.add('user-status');
                        const span = document.createElement('span');
                        span.classList.add('badge', 'badge-dot', 'bg-success');
                        const small2 = document.createElement('small');
                        small2.textContent = '';

                        user_status.appendChild(span);
                        user_status.appendChild(small2);

                        user_info.appendChild(h6);
                        user_info.appendChild(small);
                        user_info.appendChild(user_status);

                        const add_btn = document.createElement('div');
                        add_btn.classList.add('add-btn');

                        const button = document.createElement('div');
                        button.classList.add('badge', 'bg-success');
                        button.textContent = `${item.vote_count}`;

                        add_btn.appendChild(button);

                        div2.appendChild(user_info);
                        div2.appendChild(add_btn);

                        div1.appendChild(div2);

                        a.appendChild(img);
                        a.appendChild(div1);

                        var civility = `${item.civility}`;
                        if(item.vote_count > 0){
                            if(civility == "Mr"){
                                containerMr.appendChild(a);
                            }else{
                                containerMme.appendChild(a);
                            }
                        }
                        
                        
                    });
                })
                .catch(error => {
                    console.error(error);
                });
        }

        // Fetch data every 1 minute
        setInterval(fetchData, 30 * 1000);

        // Fetch data initially
        fetchData();
    </script>